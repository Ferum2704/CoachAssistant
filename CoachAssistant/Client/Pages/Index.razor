@page "/"
@using CoachAssistant.Client.Pages.Tournaments

@attribute [Authorize]
@inject TournamentService TournamentService
@inject IAccountManager AccountManager
@inject IMapper Mapper
@inject IDialogService DialogService

<AuthorizeView Roles="Manager">
    <Authorized>
        <MudPaper Class="d-flex flex-column align-center justify-center" MaxWidth="100vw" Height="100vh">
            <MudButton Variant="Variant.Filled" Size="Size.Large" Color="Color.Primary" OnClick="OpenAddTournamentDialog">Додати турнір</MudButton>
        </MudPaper>
    </Authorized>
</AuthorizeView>

@code {
    private async Task OpenAddTournamentDialog()
    {
        var options = new DialogOptions { MaxWidth = MaxWidth.Small, FullWidth = true };
        var parameters = new DialogParameters<AddEditTournamentDialog>();

        var dialog = DialogService.Show<AddEditTournamentDialog>("Edit Team", parameters, options);
        var result = (await dialog.Result).Data as TournamentViewModel;

        if (result is not null)
        {
            var newTournament = await TournamentService.Add(Mapper.Map<TournamentModel>(result));
            TournamentService.AddTournament(newTournament);
        }
    }
}